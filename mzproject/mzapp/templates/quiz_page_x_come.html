<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Quiz Timer</title>
        {% load static %}
        <link rel="stylesheet" type="text/css" href="{% static 'quiz-page.css' %}" />
    </head>
    <body>
        <div id="feedbackModal" class="modal" style="display: none">
            <div class="modal-content">
                <img id="feedbackImage" src="" alt="Feedback" />
            </div>
        </div>
        <div class="timer-wrapper">
            <div class="timer" id="timer-bar"></div>
            <div class="timer-text" id="timer-text">10.000초</div>
        </div>
        <div class="question">{{ quiz.quiz }}</div>
        <div class="answer-container">
            <div class="answer-wrapper">
                <a
                    class="answer"
                    href="{% if next_quiz_id %}{% url 'quiz_page' next_quiz_id %}{% else %}{% url 'result_page' %}{% endif %}"
                    data-answer="1"
                >
                    <div class="answer-num">A</div>
                    {{ quiz.op1 }}
                </a>
                <a
                    class="answer"
                    href="{% if next_quiz_id %}{% url 'quiz_page' next_quiz_id %}{% else %}{% url 'result_page' %}{% endif %}"
                    data-answer="2"
                >
                    <div class="answer-num">B</div>
                    {{ quiz.op2 }}
                </a>
            </div>
            <div class="answer-wrapper">
                <a
                    class="answer"
                    href="{% if next_quiz_id %}{% url 'quiz_page' next_quiz_id %}{% else %}{% url 'result_page' %}{% endif %}"
                    data-answer="3"
                >
                    <div class="answer-num">C</div>
                    {{ quiz.op3 }}
                </a>
                <a
                    class="answer"
                    href="{% if next_quiz_id %}{% url 'quiz_page' next_quiz_id %}{% else %}{% url 'result_page' %}{% endif %}"
                    data-answer="4"
                >
                    <div class="answer-num">D</div>
                    {{ quiz.op4 }}
                </a>
            </div>
        </div>
        {% if gimic %}
        <p>{{ gimic }}</p>
        {% endif %}
        <script>
            {% if quiz.answer == 1 %}
                const correctButton = document.querySelector('.answer[data-answer="1"]');
            {% elif quiz.answer == 2 %}
                const correctButton = document.querySelector('.answer[data-answer="2"]');
            {% elif quiz.answer == 3 %}
                const correctButton = document.querySelector('.answer[data-answer="3"]');
            {% elif quiz.answer == 4 %}
                const correctButton = document.querySelector('.answer[data-answer="4"]');
            {% endif %}
            const answer = {{quiz.answer}};

            const answerButtonId = `answer-${answer}`;
            const answerButton = document.getElementById(answerButtonId);

            const otherButtons = Array.from(document.querySelectorAll('.answer')).filter(
                (btn) => btn.getAttribute('data-answer') !== answer.toString()
            );

            setTimeout(() => {
                const randomButton = otherButtons[Math.floor(Math.random() * otherButtons.length)];

                document.addEventListener('mousemove', function (e) {
                    const mouseX = e.clientX;
                    const mouseY = e.clientY;

                    const buttonWidth = randomButton.offsetWidth;
                    const buttonHeight = randomButton.offsetHeight;

                    randomButton.style.position = 'absolute';
                    randomButton.style.left = `${mouseX - buttonWidth / 2}px`;
                    randomButton.style.top = `${mouseY - buttonHeight / 2}px`;
                    randomButton.style.transition = 'all 0.3s ease';
                });
            }, 2000); // 2초 후에 실행합니다.
        </script>
    </body>
</html>
